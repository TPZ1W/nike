<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org" 
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:fragment="head(title)">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${title} + ' - NICESTORE'">NICESTORE</title>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <link rel="stylesheet" th:href="@{/css/shop-icons.css}">
</head>

<header th:fragment="header">
    <!-- Top Bar -->
    <div class="bg-dark text-white py-2">
        <div class="container">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <small><i class="fas fa-phone me-2"></i>1900 1234</small>
                    <small class="ms-3"><i class="fas fa-envelope me-2"></i>contact@nicestore.com</small>
                </div>
                <div class="d-flex align-items-center">
                    <div class="dropdown me-3">
                        <button class="btn btn-sm text-white dropdown-toggle p-0" type="button" id="languageDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                            <small>Ti·∫øng Vi·ªát</small>
                        </button>
                        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="languageDropdown">
                            <li><a class="dropdown-item" href="#">Ti·∫øng Vi·ªát</a></li>
                            <li><a class="dropdown-item" href="#">English</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Navigation -->
    <nav class="navbar navbar-expand-lg main-nav">
        <div class="container">
            <a class="navbar-brand" th:href="@{/}">NICESTORE</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" th:href="@{/}">Trang ch·ªß</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMen" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            Nam
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="navbarDropdownMen">
                            <li><a class="dropdown-item" th:href="@{/products/men/shoes}">Gi√†y d√©p</a></li>
                            <li><a class="dropdown-item" th:href="@{/products/men/clothing}">Qu·∫ßn √°o</a></li>
                            <li><a class="dropdown-item" th:href="@{/products/men/accessories}">Ph·ª• ki·ªán</a></li>
                        </ul>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownWomen" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            N·ªØ
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="navbarDropdownWomen">
                            <li><a class="dropdown-item" th:href="@{/products/women/shoes}">Gi√†y d√©p</a></li>
                            <li><a class="dropdown-item" th:href="@{/products/women/clothing}">Qu·∫ßn √°o</a></li>
                            <li><a class="dropdown-item" th:href="@{/products/women/accessories}">Ph·ª• ki·ªán</a></li>
                        </ul>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownKids" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            Tr·∫ª em
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="navbarDropdownKids">
                            <li><a class="dropdown-item" th:href="@{/products/kids/boys}">B√© trai</a></li>
                            <li><a class="dropdown-item" th:href="@{/products/kids/girls}">B√© g√°i</a></li>
                        </ul>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" th:href="@{/collections/sale}">Khuy·∫øn m√£i</a>
                    </li>
                </ul>
                
                <div class="d-flex align-items-center">
                    <!-- Search -->
                    <div class="dropdown me-3">
                        <button class="btn" type="button" id="searchDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="fas fa-search"></i>
                        </button>
                        <div class="dropdown-menu dropdown-menu-end p-3" style="width: 300px;" aria-labelledby="searchDropdown">
                            <form>
                                <div class="input-group">
                                    <input type="text" class="form-control" placeholder="T√¨m ki·∫øm...">
                                    <button class="btn btn-dark" type="submit"><i class="fas fa-search"></i></button>
                                </div>
                            </form>
                        </div>
                    </div>
                    
                    <!-- User Menu -->
                    <div class="me-3">
                        <div sec:authorize="isAnonymous()">
                            <a th:href="@{/login}" class="btn">
                                <i class="fas fa-user"></i>
                            </a>
                        </div>
                        <div sec:authorize="isAuthenticated()" class="dropdown">
                            <button class="btn dropdown-toggle" type="button" id="userMenu" 
                                    data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="fas fa-user"></i>
                            </button>
                            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userMenu">
                                <li><h6 class="dropdown-header" sec:authentication="name">Username</h6></li>
                                <li><a class="dropdown-item" th:href="@{/profile}">T√†i kho·∫£n</a></li>
                                <li><a class="dropdown-item" th:href="@{/orders}">ƒê∆°n h√†ng</a></li>
                                <li><a class="dropdown-item" th:href="@{/wishlist}">Y√™u th√≠ch</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li>
                                    <form th:action="@{/logout}" method="post">
                                        <button class="dropdown-item" type="submit">ƒêƒÉng xu·∫•t</button>
                                    </form>
                                </li>
                            </ul>
                        </div>
                    </div>
                    
                    <!-- Cart -->
                    <div>
                        <a th:href="@{/cart}" class="btn position-relative cart-icon">
                            <i class="fas fa-shopping-cart"></i>
                            <span class="cart-badge" sec:authorize="isAuthenticated()">2</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </nav>
</header>

<div th:fragment="footer">
    <!-- Newsletter Section -->
    <section class="newsletter-section">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-md-8 text-center">
                    <h3 class="mb-4">ƒêƒÇNG K√ù NH·∫¨N B·∫¢N TIN</h3>
                    <p class="mb-4">ƒêƒÉng k√Ω ƒë·ªÉ nh·∫≠n nh·ªØng th√¥ng tin m·ªõi nh·∫•t v·ªÅ s·∫£n ph·∫©m, khuy·∫øn m√£i v√† s·ª± ki·ªán ƒë·∫∑c bi·ªát.</p>
                    <form class="newsletter-form">
                        <div class="input-group mb-3">
                            <input type="email" class="form-control newsletter-input" placeholder="Email c·ªßa b·∫°n" aria-label="Email c·ªßa b·∫°n">
                            <button class="btn newsletter-btn" type="submit">ƒêƒÇNG K√ù</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Footer -->
    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col-md-3 mb-4 mb-md-0">
                    <h5 class="footer-title">NICESTORE</h5>
                    <p>Th∆∞∆°ng hi·ªáu th·ªùi trang h√†ng ƒë·∫ßu Vi·ªát Nam, cung c·∫•p c√°c s·∫£n ph·∫©m ch·∫•t l∆∞·ª£ng cao v·ªõi thi·∫øt k·∫ø hi·ªán ƒë·∫°i.</p>
                    <div class="mt-3">
                        <p><i class="fas fa-map-marker-alt me-2"></i> 123 ƒê∆∞·ªùng XYZ, Ph∆∞·ªùng ABC, TP.HCM</p>
                        <p><i class="fas fa-phone me-2"></i> 1900 1234</p>
                        <p><i class="fas fa-envelope me-2"></i> contact@nicestore.com</p>
                    </div>
                </div>
                
                <div class="col-md-3 mb-4 mb-md-0">
                    <h5 class="footer-title">S·∫¢N PH·∫®M</h5>
                    <ul class="footer-list">
                        <li><a href="#">Gi√†y Nam</a></li>
                        <li><a href="#">Gi√†y N·ªØ</a></li>
                        <li><a href="#">Qu·∫ßn √°o Nam</a></li>
                        <li><a href="#">Qu·∫ßn √°o N·ªØ</a></li>
                        <li><a href="#">Ph·ª• ki·ªán</a></li>
                        <li><a href="#">S·∫£n ph·∫©m m·ªõi</a></li>
                        <li><a href="#">Khuy·∫øn m√£i</a></li>
                    </ul>
                </div>
                
                <div class="col-md-3 mb-4 mb-md-0">
                    <h5 class="footer-title">H·ªñ TR·ª¢</h5>
                    <ul class="footer-list">
                        <li><a href="#">Trung t√¢m tr·ª£ gi√∫p</a></li>
                        <li><a href="#">C√°ch mua h√†ng</a></li>
                        <li><a href="#">V·∫≠n chuy·ªÉn & giao h√†ng</a></li>
                        <li><a href="#">Tr·∫£ h√†ng & ho√†n ti·ªÅn</a></li>
                        <li><a href="#">Ph∆∞∆°ng th·ª©c thanh to√°n</a></li>
                        <li><a href="#">Li√™n h·ªá ch√∫ng t√¥i</a></li>
                        <li><a href="#">FAQ</a></li>
                    </ul>
                </div>
                
                <div class="col-md-3">
                    <h5 class="footer-title">V·ªÄ CH√öNG T√îI</h5>
                    <ul class="footer-list">
                        <li><a href="#">Th√¥ng tin c√¥ng ty</a></li>
                        <li><a href="#">Tuy·ªÉn d·ª•ng</a></li>
                        <li><a href="#">ƒêi·ªÅu kho·∫£n & ƒëi·ªÅu ki·ªán</a></li>
                        <li><a href="#">Ch√≠nh s√°ch b·∫£o m·∫≠t</a></li>
                        <li><a href="#">Li√™n h·ªá</a></li>
                    </ul>
                    
                    <h5 class="footer-title mt-4">K·∫æT N·ªêI V·ªöI CH√öNG T√îI</h5>
                    <div class="social-icons">
                        <a href="#" class="social-icon"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="social-icon"><i class="fab fa-instagram"></i></a>
                        <a href="#" class="social-icon"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="social-icon"><i class="fab fa-youtube"></i></a>
                        <a href="#" class="social-icon"><i class="fab fa-tiktok"></i></a>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="footer-bottom text-center">
            <div class="container">
                <p class="mb-0">¬© 2025 NICESTORE. T·∫•t c·∫£ c√°c quy·ªÅn ƒë∆∞·ª£c b·∫£o l∆∞u.</p>
            </div>
        </div>
    </footer>
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Global logout handler -->
    <script>
        // üç™ X·ª≠ l√Ω logout: g·ªçi API ƒë·ªÉ clear cookies
        document.addEventListener('DOMContentLoaded', function() {
            const logoutForms = document.querySelectorAll('form[action*="/logout"]');
            logoutForms.forEach(form => {
                form.addEventListener('submit', function(e) {
                    e.preventDefault(); // Prevent default form submission
                    
                    // Call logout API to clear cookies
                    fetch('/api/v1/auth/logout', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        credentials: 'include' // Include cookies for authentication
                    })
                    .then(response => response.json())
                    .then(data => {
                        console.log('üç™ Logout successful, cookies cleared');
                        // Redirect to login page
                        window.location.href = '/login';
                    })
                    .catch(error => {
                        console.error('Logout error:', error);
                        // Even if API fails, redirect to login
                        window.location.href = '/login';
                    });
                });
            });
        });
    </script>
</div>
</html>